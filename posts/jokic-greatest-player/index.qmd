---
title: "CHANGE THIS TO BE THE TITLE OF YOUR POST"
author: "Sawyer Belair"
date: '2022-11-04'
categories: [basketball, nba, analysis]
image: "image.png"
format: 
  html:
    code-fold: true
---


The 2021-22 NBA season showcased the pinnacle of Nikola Jokic's basketball abilities, but some still doubt his status as the reigning greatest player in the world.

```{r}
library(tidyverse)
library(ggrepel)
library(cowplot)
library(ggalt)

advlogs <- read_csv("advancedlogs21.csv")
advplayers <- advlogs %>% filter(G >= 43)
advelites <- advplayers%>% filter(BPM > 5, PER > 23)

alltimeper <- read_csv("alltimeper.csv")
alltimebpm <- read_csv("alltimebpm.csv")
alltimersadv <- alltimebpm %>% inner_join(alltimeper, by=c("Player"))

jokeradv <- advelites %>% filter(Player == "Nikola Jokic")
freakadv <- advelites %>% filter(Player == "Giannis Antetokounmpo")
processadv <- advelites %>% filter(Player == "Joel Embiid")
kingadv <- advelites %>% filter(Player == "LeBron James")
sniperadv <- advelites %>% filter(Player == "Kevin Durant")
bucketsadv <- advelites %>% filter(Player == "Jimmy Butler")
lukaadv <- advelites %>% filter(Player == "Luka Doncic")
iceadv <- advelites %>% filter(Player == "Trae Young")
jaadv <- advelites %>% filter(Player == "Ja Morant")

freakalltimeadv <- alltimersadv %>% filter(Player == "Giannis Antetokounmpo (2021-22)")
processalltimeadv <- alltimersadv %>% filter(Player == "Joel Embiid (2021-22)")
jokeralltimeadv <- alltimersadv %>% filter(Player == "Nikola Jokic (2021-22)")
chefalltimeadv <- alltimersadv %>% filter(Player == "Stephen Curry (2015-16)")
kingalltimeadv <- alltimersadv %>% filter(Player == "LeBron James (2008-09)")
mjalltimeadv <- alltimersadv %>% filter(Player == "Michael Jordan (1987-88)")
admiralalltimeadv <- alltimersadv %>% filter(Player == "David Robinson (1993-94)")
russalltimeadv <- alltimersadv %>% filter(Player == "Russell Westbrook (2016-17)")
alltimeadv <- bind_rows(chefalltimeadv, kingalltimeadv, mjalltimeadv, admiralalltimeadv, russalltimeadv, freakalltimeadv, processalltimeadv, jokeralltimeadv)

ggplot() + geom_point(data = advplayers, aes(x = BPM, y = PER), color = "grey") + 
  geom_point(data = jokeradv, aes(x = BPM, y = PER), color = "dark blue", size = 2) + 
  geom_point(data = freakadv, aes(x = BPM, y = PER), color = "dark green", size = 2) +
  geom_point(data = processadv, aes(x = BPM, y = PER), color = "blue", size = 2) +
  geom_point(data = kingadv, aes(x = BPM, y = PER), color = "gold", size = 2) +
  geom_point(data = sniperadv, aes(x = BPM, y = PER), color = "black", size = 2) +
  geom_point(data = bucketsadv, aes(x = BPM, y = PER), color = "dark red", size = 2) +
  geom_point(data = lukaadv, aes(x = BPM, y = PER), color = "light blue", size = 2) +
  geom_point(data = iceadv, aes(x = BPM, y = PER), color = "yellow green", size = 2) +
  geom_point(data = jaadv, aes(x = BPM, y = PER), color = "steel blue", size = 2) +
  geom_text_repel(
    data=advelites, 
    aes(x=BPM, y=PER, label=Player), box.padding = .5) +
  labs(
    title = "Among his peers, the Joker was a freakish outlier",
    subtitle = "2021-22 box-score stats prove how vital he was to an otherwise hopeless Nuggets team",
    caption = "Data from basketball-reference.com | By: Sawyer Belair"
  ) +
  labs(
    x = "Box Plus-Minus (BPM)", y = "Player Efficiency Rating (PER)"
  ) +
  theme(
    plot.title.position = "plot" ### Aligns the title to the left
  ) +
  theme_minimal()
```

```{r}
ggplot() + 
  geom_point(data = alltimersadv, aes(x = BPM, y = PER), color = "grey") +
  geom_point(data = jokeralltimeadv, aes(x = BPM, y = PER), color = "dark blue", size = 2) + 
  geom_point(data = freakalltimeadv, aes(x = BPM, y = PER), color = "dark green", size = 2) +
  geom_point(data = chefalltimeadv, aes(x = BPM, PER), color = "gold", size = 2) +
  geom_point(data = kingalltimeadv, aes(x = BPM, PER), color = "maroon", size = 2) +
  geom_point(data = mjalltimeadv, aes(x = BPM, PER), color = "red", size = 2) +
  geom_point(data = admiralalltimeadv, aes(x = BPM, PER), color = "black", size = 2) +
  geom_point(data = russalltimeadv, aes(x = BPM, PER), color = "orange", size = 2) +
  geom_text_repel(
    data = alltimeadv, aes(x=BPM, y=PER, label = Player), box.padding = .5
  )
```


###Stacked bar charts
```{r}
shtlogs <- read_csv("shootinglogs21.csv")
shtplayers <- shtlogs %>% filter(G >= 43)
jokersht <- shtplayers %>% filter(Player == "Nikola Jokic")
freaksht <- shtplayers %>% filter(Player == "Giannis Antetokounmpo")
processsht <- shtplayers %>% filter(Player == "Joel Embiid")
kingsht <- shtplayers %>% filter(Player == "LeBron James")
snipersht <- shtplayers %>% filter(Player == "Kevin Durant")
bucketssht <- shtplayers %>% filter(Player == "Jimmy Butler")
lukasht <- shtplayers %>% filter(Player == "Luka Doncic")
icesht <- shtplayers %>% filter(Player == "Trae Young")
jasht <- shtplayers %>% filter(Player == "Ja Morant")
shtelites <- bind_rows(joker, freak, process, king, sniper, buckets, luka, ice, ja)

shotchart <- shtelites  %>% select(Player, `at 0-3ft`, `at 3-10ft`, `at 10-16ft`, `at 16ft-3P`, `at 3P`)
shotchartwide <- shotchart %>% pivot_longer(
  cols = starts_with("at"),
  names_to = "Distance",
  values_to = "% from"
)
shotchartwider <- read_csv("shotchartwider.csv")

effchart <- shtelites %>% select(Player, `0-3ft%`, `3-10ft%`, `10-16ft%`, `16ft-3P%`, `3P%`)
effchartwide <- effchart %>% pivot_longer(
  cols=ends_with("%"), 
  names_to="Distance",
  values_to="FG%"
)
effchartwider <- read_csv("effchartwider.csv")
```

```{r}
shots <- ggplot() +
    geom_bar(data = shotchartwider, aes(x=reorder(Player, -Sort), weight=`% from`, fill = Order)) +
    scale_fill_manual(values = c("blue", "green", "yellow", "orange", "red"), labels = c("3P", "16ft-3P", "10-16ft", "3-10ft", "0-3ft")) +
    coord_flip() + 
    labs(x="", y="% of shots attempted")
  
eff <- ggplot() +
    geom_bar(data = effchartwider, aes(x=reorder(Player, `FG%`), weight=`FG%`, fill = Order)) +
    scale_fill_manual(values = c("blue", "green", "yellow", "orange", "red"), labels = c("3P", "16ft-3P", "10-16ft", "3-10ft", "0-3ft")) +
    labs(x="", y="% Efficiency") +
  theme(
    plot.title.position = "plot",
    legend.position = "none"
  ) +
    coord_flip()
  
  plot_grid(shots, eff, ncol = 1)
```


###Dumbbell charts
```{r}
winshares <- read_csv("winshares.csv")
ggplot() + 
  geom_dumbbell(
    data = winshares, 
    aes(y = Player, x = DWS, xend = OWS),
    size = 2, 
    colour = "grey",
    colour_x = "blue",
    colour_xend = "orange") + 
  labs(
    x = "Win Shares", y = ""
  )
  theme_minimal()
```